services:
  flask-backend:
    container_name: ${backend_container_name}
    image: ${backend_repo_and_image_tag}
    build: 
      context: ./b
      dockerfile: Dockerfile
      args:
        backend_container_port: ${backend_container_port}
    network_mode: "host"
    ports:
      - "${backend_host_port}:${backend_container_port}"
    env_file:
      - ./b/.env
    restart: unless-stopped
    depends_on:
      - react-frontend

  react-frontend:
    container_name: ${frontend_container_name}
    image: ${frontend_repo_and_image_tag}
    build:
      context: ./f
      dockerfile: Dockerfile
      args:
        frontend_container_port: ${frontend_container_port}
        VITE_APP_ENV: ${VITE_APP_ENV}
        frontend_container_app_service_domain: ${FRONTEND_CONTAINER_APP_SERVICE_DOMAIN}
    ports:
      - "${frontend_host_port}:${frontend_container_port}"
    restart: unless-stopped
